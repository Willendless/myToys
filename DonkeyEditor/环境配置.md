# 环境配置

## debian类操作系统安装

## virtualBox 分辨率配置

1. cd进入VirtualBox安装文件夹下
2. 执行`VBoxManage setextradata global GUI/MaxGuestResolution any`
3. 虚拟机内部此时应当能够调整分辨率

## ssh tunnel配置

1. 虚拟机内安装openssh-server
    + 注：如果openssh-client版本报错，需要将其降级到openssh-server适用的版本`sudo apt install openssh-client=1:7.9p1-10+deb10u1`

2. 虚拟机网络配置
    + *控制*->*网络*(连接方式选择**网络地址转换(NAT)**->*高级*->*端口转发*：添加端口转发规则
        + 例：名称(ssh)，协议(TCP)，主机端口(2201)，子系统端口(22)

3. 主机网络配置
    + *C:\Windows\System32\drivers\etc\hosts*下添加IP地址到hostname的映射
        + 例：127.0.0.1 debian

4. 主机测试连接
    + *win+s*搜索cmd，打开终端
    + `ssh username@debian -p 2201`输入密码，应当能够连接成功

5. vscode配置remote连接
    + 下载Remote-SSH插件
    + *vscode*->*左侧工具栏*->*Remote Explorer*->*Add New*
        + 例：`ssh username@debian -p 2201`
        + *弹出对话框*->*Open config* config文件内应能看到
            ```s
                Host debian
                HostName debian
                User username
                Port 2201
            ```

6. vscode连接
    + *vscode*->*左下角Remote连接图标*->*Remote-SSH: Connect to Host*->*debian*
    + 输入密码后应能成功连接

7. 配置免密码登录
    + 在虚拟机中执行`ssh-keygen -t rsa`，`~/.ssh`目录下生成id_rsa私钥文件和id_rsa.pub公钥文件并在该目录下创建`authorized_keys`文件
    + 为配置免密码登录，需要将主机**公钥**文件添加进`authorized_keys`文件中。注：windows下.ssh目录位置位于`C:Users\[username]\.ssh\`

## 虚拟机内工具安装

vscode连接到虚拟机后，*ctrl + `*打开终端

### 以安装git为例

如果出现`Package xxx has no installation candidate`问题，需要配置apt source file.运行以下命令将清华镜像源添加到apt源列表文件中：

`echo "deb http://mirrors.tuna.tsinghua.edu.cn/debian/ stable main" > /etc/apt/sources.list`

如果收到类似`Permission denied`的错误信息，需要使用root权限进行操作。系统安装完成后，用户默认不会被添加到sudo用户组中，因此需要执行以下命令：

```shell
su - # 首先切换到su用户
adduser username sudo # 使用自己设置的username
exit
```

添加源后，查看apt源列表

```cat /etc/apt/sources.list```

更新apt源

```sudo apt-get update```

此时应当能够正常下载git。
